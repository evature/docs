

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. API - The Request &mdash; Eva 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Eva 1.0 documentation" href="index.html"/>
        <link rel="next" title="6. API - The Response" href="response.html"/>
        <link rel="prev" title="4. The HTTP RESTful API" href="api.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Eva
          

          
            
            <img src="_static/logo4.jpg" class="logo" />
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdks.html">2. The Mobile SDKs</a></li>
<li class="toctree-l1"><a class="reference internal" href="botkit.html">3. The Eva BotKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">4. The HTTP RESTful API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. API - The Request</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-text">5.1. input_text</a></li>
<li class="toctree-l2"><a class="reference internal" href="#site-code-and-api-key">5.2. site_code and api_key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uid">5.3. uid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scope">5.4. scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#context">5.5. context</a></li>
<li class="toctree-l2"><a class="reference internal" href="#locale">5.6. locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bias">5.7. bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="#home">5.8. home</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ip-addr">5.9. ip_addr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#longitude-and-latitude">5.10. longitude and latitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-zone">5.11. time_zone</a></li>
<li class="toctree-l2"><a class="reference internal" href="#feedback">5.12. feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comment">5.13. comment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#session-id">5.14. session_id</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dialog-response">5.15. dialog_response</a></li>
<li class="toctree-l2"><a class="reference internal" href="#from-speech">5.16. from_speech</a></li>
<li class="toctree-l2"><a class="reference internal" href="#android-ver">5.17. android_ver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#device">5.18. device</a></li>
<li class="toctree-l2"><a class="reference internal" href="#language">5.19. language</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="response.html">6. API - The Response</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Eva</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>5. API - The Request</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-the-request">
<h1>5. API - The Request<a class="headerlink" href="#api-the-request" title="Permalink to this headline">¶</a></h1>
<p>All text requests are handled by a Web API server, available at <cite>http://freeapi.evature.com/vX.Y</cite></p>
<p>Please register here to get started for free: <a class="reference external" href="http://www.evature.com/registration/form">http://www.evature.com/registration/form</a></p>
<p>Here is an example of a text request:</p>
<p><cite>http://freeapi.evature.com/v1.0?site_code=&lt;your site_code&gt;&amp;api_key=&lt;your api_key&gt;&amp;input_text=chicago+monday</cite></p>
<p>The text request is sent as an HTTP GET method with the following parameters:</p>
<div class="section" id="input-text">
<h2>5.1. input_text<a class="headerlink" href="#input-text" title="Permalink to this headline">¶</a></h2>
<p>The input query string in URL format and UTF-8 encoded.</p>
<p>There may be more than a single input text, for example when the source of the text is the hypotheses of a
speech recognition engine. In this case see: <a class="reference internal" href="api.html#multiple-input-text"><span class="std std-ref">Multiple Input Texts</span></a>.</p>
</div>
<div class="section" id="site-code-and-api-key">
<span id="id1"></span><h2>5.2. site_code and api_key<a class="headerlink" href="#site-code-and-api-key" title="Permalink to this headline">¶</a></h2>
<p>Designated username/password credentials provided by Evature per customer site or application using the Web API or the Mobile SDKs.</p>
<p>Users receive the credentials after registration.</p>
<p>Mandatory fields.</p>
</div>
<div class="section" id="uid">
<span id="id2"></span><h2>5.3. uid<a class="headerlink" href="#uid" title="Permalink to this headline">¶</a></h2>
<p>A unique identifier to help Eva track the end user across sessions, see <a class="reference internal" href="api.html#metasessions"><span class="std std-ref">Meta-Sessions</span></a>.
This field, while not mandatory, is very important, as it is the only way Eva can group users across sessions
which allows for better understanding.
On Android if you have the READ_PHONE_STATE permissions for your application you can use the deviceId</p>
<div class="literal-block-wrapper container" id="java-snippet">
<div class="code-block-caption"><span class="caption-text">Java snippet</span><a class="headerlink" href="#java-snippet" title="Permalink to this code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getDeviceId</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">deviceId</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">TelephonyManager</span> <span class="n">telephonyManager</span> <span class="o">=</span> <span class="o">(</span><span class="n">TelephonyManager</span><span class="o">)</span> <span class="n">activity</span><span class="o">.</span><span class="na">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">TELEPHONY_SERVICE</span><span class="o">);</span>
      <span class="n">deviceId</span><span class="o">=</span><span class="n">telephonyManager</span><span class="o">.</span><span class="na">getDeviceId</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAg</span><span class="o">,</span> <span class="s">&quot;Can&#39;t read the Device Id because of missing READ_PHONE_STATE permission&quot;</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">deviceId</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>Another alternative may be to to use the Google Advertisement ID:</p>
<p><a class="reference external" href="https://support.google.com/googleplay/android-developer/answer/6048248?hl=en">https://support.google.com/googleplay/android-developer/answer/6048248?hl=en</a></p>
<p>or to generate a random string and save it to preferences.</p>
<p><a class="reference external" href="http://stackoverflow.com/a/17625641">http://stackoverflow.com/a/17625641</a></p>
<p>Then add it to the URL:</p>
<div class="literal-block-wrapper container" id="id3">
<div class="code-block-caption"><span class="caption-text">Java snippet</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">evatureUrl</span> <span class="o">+=</span> <span class="s">&quot;&amp;uid=&quot;</span> <span class="o">+</span><span class="n">getDeviceId</span><span class="o">();</span>
</pre></div>
</div>
</div>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="scope">
<span id="id4"></span><h2>5.4. scope<a class="headerlink" href="#scope" title="Permalink to this headline">¶</a></h2>
<p>Defines the types of travel services are provided by the application/web site.</p>
<p>The value is a concatenated string with a single letter representing each of the travel services available:</p>
<p>f - flights</p>
<p>h - hotels</p>
<p>v - flight and hotel vacation packages</p>
<p>c - car rental</p>
<p>r - cruise</p>
<p>s - ski</p>
<p>e - explore (inspiration search / tours and activities within a location)</p>
<p>t - trains</p>
<p>p - airports</p>
<p>If for example an application offers hotels only, you should send: scope=h,
while a web site for flights and cruises should send: scope=fr.</p>
</div>
<div class="section" id="context">
<span id="id5"></span><h2>5.5. context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h2>
<p>Defines the <strong>current</strong> state of the site/application.</p>
<p>The value is a single letter representing current context, with the same enumeration as <a class="reference internal" href="#scope">scope</a>.</p>
<p>For example: if an app/site supports both flights and hotels, and a user is currently viewing the flights page,
the app/site should send &#8220;&amp;context=f&#8221; and while the user is viewing hotels - &#8220;&amp;context=h&#8221;.</p>
<p>The result is that if the user says &#8220;New York&#8221; while in the flights context
Eva would interpret this utterance as a <strong>flight</strong> request, either to or from New York, while if in the hotel context
the same input would mean <strong>hotel</strong> in New York.</p>
</div>
<div class="section" id="locale">
<h2>5.6. locale<a class="headerlink" href="#locale" title="Permalink to this headline">¶</a></h2>
<p>Receives one of the values: UK, US, IL -
specifying the date notation (10/3/2010 is March 10th in UK/IL and October 3rd in the US)
and the days of the weekend (Sat-Sun in UK/US, Fri-Sat in IL).</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="bias">
<h2>5.7. bias<a class="headerlink" href="#bias" title="Permalink to this headline">¶</a></h2>
<p>Specify a list of locations to be biased as the home location of the user. Values are the location Geoname IDs.</p>
<p>Example: bias=3017382,2510769</p>
<p>Represents bias to France or Spain. Bias means that the departure of any trip would always be from within the bias locations.</p>
<p>For example: &#8220;NY London Monday&#8221; would mean a flight from NY to London on Monday, but if bias was set to be UK, the same input would be interpreted as flight from London to NY on Monday.</p>
<p>It is highly important to set bias in sites that imply the origin of the trip, for example sites that sell vacation packages originating in the UK.</p>
<p>Note: If you define both &#8220;home&#8221; and &#8220;bias&#8221; - home must be a location within the bias (For example London and UK).</p>
</div>
<div class="section" id="home">
<h2>5.8. home<a class="headerlink" href="#home" title="Permalink to this headline">¶</a></h2>
<p>The home of the end user sending the request, if specifically known to our client (for example through registration).</p>
<p>The value can be either the Geoname ID for the home location (see <a class="reference external" href="http://www.geonames.org/">http://www.geonames.org/</a>) OR a string for the location name</p>
<p>Example (Geoname ID): &#8220;home=5128581&#8221; means home is New York City - <a class="reference external" href="http://www.geonames.org/5128581">http://www.geonames.org/5128581</a>.</p>
<p>Example (name string): &#8220;home=paris&#8221; means the home is Paris, France, or &#8220;home=paris TX&#8221; means home is Paris Texas.</p>
</div>
<div class="section" id="ip-addr">
<h2>5.9. ip_addr<a class="headerlink" href="#ip-addr" title="Permalink to this headline">¶</a></h2>
<p>The end user&#8217;s IP address, if known (e.g. extracted from the META REMOTE_ADDR HTTP request parameter).
The IP address will be used to identify the user&#8217;s home location if no better coordinates are provided.</p>
<p>If a specific &#8216;home&#8217; was defined &#8216;ip_addr&#8217; will be ignored.</p>
<p>Not needed if the end device (e.g. a mobile phone) is contacting Eva directly.</p>
</div>
<div class="section" id="longitude-and-latitude">
<h2>5.10. longitude and latitude<a class="headerlink" href="#longitude-and-latitude" title="Permalink to this headline">¶</a></h2>
<p>The end user&#8217;s current coordinates, when available.</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="time-zone">
<h2>5.11. time_zone<a class="headerlink" href="#time-zone" title="Permalink to this headline">¶</a></h2>
<p>Timezone - The end user&#8217;s timezone in respect to the Coordinated Universal Time (UTC).</p>
<p>The timezone is very helpful in understanding expressions such as &#8220;tomorrow morning&#8221;.</p>
<p>The value is a string representing the offset from UTC in the following format &#8220;+/-HH:MM&#8221;.</p>
<p>HH represents the hour offset in the range -12 and 14</p>
<p>MM represents the minutes offset</p>
<p>Examples:</p>
<p>&#8220;time_zone=+08:00&#8221; means the UTC+8 timezone.</p>
<p>&#8220;time_zone=-05:30&#8221; means the UTC-5:30 timezone.</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="feedback">
<h2>5.12. feedback<a class="headerlink" href="#feedback" title="Permalink to this headline">¶</a></h2>
<p>Enables to feedback Eva through the API regarding the parsing of a particular request.
This field should NOT be present in regular API calls.</p>
<p>Feedback requests should only include <a class="reference internal" href="#site-code-and-api-key"><span class="std std-ref">credentials</span></a>, an optional <a class="reference internal" href="#comment">comment</a> and
the <a class="reference internal" href="response.html#transaction-key"><span class="std std-ref">transaction_key</span></a>.</p>
<p>Feedback requests do NOT get parsed and return a success message only.
The feedback is logged onto Eva for further learning and processing.</p>
<p>Feedback values can be:</p>
<p>0 - Parse failed.</p>
<p>1 - Parse was partly correct.</p>
<p>2 - Parse was correct.</p>
</div>
<div class="section" id="comment">
<h2>5.13. comment<a class="headerlink" href="#comment" title="Permalink to this headline">¶</a></h2>
<p>Provide a text comment to a feedback. This will ONLY be reviewed in a request that includes the <a class="reference internal" href="#feedback">feedback</a> field.</p>
</div>
<div class="section" id="session-id">
<span id="id6"></span><h2>5.14. session_id<a class="headerlink" href="#session-id" title="Permalink to this headline">¶</a></h2>
<p>A session identifier in order to maintain state for the end user. Enables Dialogs and multi-query inputs.</p>
<p>It is both an input to Eva and an output from Eva.</p>
<p>To start a new session send EVA a request with query parameter “session_id=1”. Eva will reply with a new session_id.
Maintain the session state by passing back the received session_id in the following requests to EVA,
much like an HTTP token or cookie.</p>
<p>A session may automatically be timed out after a few minutes of inactivity, or if specifically requested by the user.</p>
<p>For an overview see <a class="reference internal" href="api.html#maintaining-state"><span class="std std-ref">Maintaining State - Sessions and Meta-Sessions</span></a>.</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="dialog-response">
<h2>5.15. dialog_response<a class="headerlink" href="#dialog-response" title="Permalink to this headline">¶</a></h2>
<p>When using sessions the dialog engine may present the end user with a multiple choice question.
When the end user selects one of these responses using a GUI,
the application must return the choice to Eva in the <em>dialog_repsonse</em> request parameter.</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="from-speech">
<span id="id7"></span><h2>5.16. from_speech<a class="headerlink" href="#from-speech" title="Permalink to this headline">¶</a></h2>
<p>When the source of the text in the input_text is from a speech recognition engine,
please add <cite>from_speech</cite> to the request parameters.
This allows Eva to correctly overcome speech recognition blunders,
as well as disable text-specific processing such as a spell checker, resulting in a faster, more accurate reply.</p>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="android-ver">
<h2>5.17. android_ver<a class="headerlink" href="#android-ver" title="Permalink to this headline">¶</a></h2>
<p>If, for some reason you are integrating Eva into an Android device using the raw API,
it greatly helps Eva with analytics and debugging to know the Android OS version</p>
<div class="literal-block-wrapper container" id="id8">
<div class="code-block-caption"><span class="caption-text">Java snippet</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">evatureUrl</span> <span class="o">+=</span> <span class="s">&quot;&amp;android_ver=&quot;</span> <span class="o">+</span><span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">android</span><span class="o">.</span><span class="na">os</span><span class="o">.</span><span class="na">Build</span><span class="o">.</span><span class="na">VERSION</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">),</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">);</span>
</pre></div>
</div>
</div>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="device">
<h2>5.18. device<a class="headerlink" href="#device" title="Permalink to this headline">¶</a></h2>
<p>If, for some reason you are integrating Eva into a mobile applications,
it greatly helps Eva with analytics and debugging to know the specific device</p>
<div class="literal-block-wrapper container" id="id9">
<div class="code-block-caption"><span class="caption-text">Java snippet</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">evatureUrl</span> <span class="o">+=</span> <span class="s">&quot;&amp;device=&quot;</span> <span class="o">+</span><span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">android</span><span class="o">.</span><span class="na">os</span><span class="o">.</span><span class="na">Build</span><span class="o">.</span><span class="na">MODEL</span><span class="o">,</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">);</span>
</pre></div>
</div>
</div>
<p>This parameter is automatically handled by <a class="reference internal" href="sdks.html#the-mobile-sdks"><span class="std std-ref">The Mobile SDKs</span></a>.</p>
</div>
<div class="section" id="language">
<h2>5.19. language<a class="headerlink" href="#language" title="Permalink to this headline">¶</a></h2>
<p>The input language per ISO 639-1.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="response.html" class="btn btn-neutral float-right" title="6. API - The Response" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral" title="4. The HTTP RESTful API" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016 Evature.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12901638-1', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>