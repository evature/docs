

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. The Eva BotKit &mdash; Eva 1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Eva 1.1 documentation" href="index.html"/>
        <link rel="next" title="4. The HTTP RESTful API" href="api.html"/>
        <link rel="prev" title="2. The Mobile SDKs" href="sdks.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Eva
          

          
            
            <img src="_static/logo4.jpg" class="logo" />
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdks.html">2. The Mobile SDKs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. The Eva BotKit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">3.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#chat-service-integrations">3.2. Chat Service Integrations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#telegram-integration">3.2.1. Telegram integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#line-integration">3.2.2. Line integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#facebook-messenger-integration">3.2.3. Facebook Messenger integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kik-integration">3.2.4. Kik integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skype-integration">3.2.5. Skype integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#applicative-webhooks">3.3. Applicative Webhooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">3.3.1. General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log-messages-between-eva-and-user">3.3.2. Log Messages between Eva and User</a></li>
<li class="toctree-l3"><a class="reference internal" href="#webhooks-health">3.3.3. Webhooks health</a></li>
<li class="toctree-l3"><a class="reference internal" href="#session-storage">3.3.4. Session Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-messages-general">3.3.5. Interactive Messages - General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-message-logging-in-end-users-oauth">3.3.6. Interactive Message - Logging In End Users - OAuth</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-message-transfer-chat-to-a-human-agent">3.3.7. Interactive Message - Transfer chat to a Human Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-message-subscribe-to-list">3.3.8. Interactive Message - Subscribe to List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-message-questionnaires">3.3.9. Interactive Message - questionnaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-message-quick-replies">3.3.10. Interactive Message - Quick Replies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#specific-webhooks">3.4. Specific Webhooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#search-for-flights">3.4.1. Search for Flights</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-for-hotels">3.4.2. Search for Hotels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-for-cars">3.4.3. Search for Cars</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-for-cruises">3.4.4. Search for Cruises</a></li>
<li class="toctree-l3"><a class="reference internal" href="#greet-the-user">3.4.5. Greet the User:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-gate-number">3.4.6. Display Gate Number</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-departure-time">3.4.7. Display Departure Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-arrival-time">3.4.8. Display Arrival Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-boarding-time">3.4.9. Display Boarding Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-boarding-pass">3.4.10. Display boarding pass</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-itinerary">3.4.11. Display Itinerary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-reservation">3.4.12. Display Reservation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cancel-reservation">3.4.13. Cancel Reservation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-in-to-flight">3.4.14. Check In To Flight</a></li>
<li class="toctree-l3"><a class="reference internal" href="#display-flight-status">3.4.15. Display Flight Status</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inverse-webhooks">3.5. Inverse Webhooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secure-invitations">3.6. Secure Invitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#confidence">3.7. Confidence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">3.7.1. Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">3.7.2. How it works</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">4. The HTTP RESTful API</a></li>
<li class="toctree-l1"><a class="reference internal" href="request.html">5. API - The Request</a></li>
<li class="toctree-l1"><a class="reference internal" href="response.html">6. API - The Response</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Eva</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>3. The Eva BotKit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-eva-botkit">
<span id="eva-botkit"></span><h1>3. The Eva BotKit<a class="headerlink" href="#the-eva-botkit" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>3.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Eva BotKit enables building a single AI assisted Bot for providing applicative Travel functionality across
all messaging platforms with a bot platform API.
Botkit bundles Eva&#8217;s Natural Language Understanding and Dialog Management features with robust cloud based spelling correction.
Furthermore, the Eva API reply is automatically parsed and dialog is handled by Eva.
The backend application is only called upon to implement applicative directives, such as <em>ShowBoardingPass</em> or <em>PerformFlightSearch</em>.
Applicative integration is done via customizable webhooks.
Eva automatically reformats the applicative webhook replies to comply with all messaging platforms so you don&#8217;t have to integrate
separately with each one.</p>
<p>Integration with all messaging platforms consists of the following steps:</p>
<ol class="arabic">
<li><p class="first"><strong>Create a new Bot</strong></p>
<p>Log in to  <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> using your Eva credentials.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For <strong>free</strong> API access please register here: <a class="reference external" href="https://w.evature.com/registration/form">https://w.evature.com/registration/form</a></p>
</div>
<p>You will be prompted to create a new Bot, proving a name, a description and a default greeting.</p>
</li>
<li><p class="first"><strong>Add a Chat Service Integration</strong></p>
<p>Add a chat integration with one of the following providers:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>* Facebook
* Telegram
* Line
* Slack
* Kik
* SMS
* WeChat
* Skype
</pre></div>
</div>
<p>The integrations are platform specific.</p>
</li>
<li><p class="first"><strong>Implement applicative webhooks</strong></p>
<p>Eva defines many webhook functions for applicative requests that may be queried by the end users.
This is usually existing functionality in your backend servers that the developer
needs to &#8220;wire&#8221; to the corresponding webhook function.</p>
<p>Here are some examples:</p>
<ul class="simple">
<li>Perform a Flight Search</li>
<li>Perform a Hotel Search</li>
<li>Show a Boarding Pass</li>
<li>Show an Itinerary</li>
</ul>
<p>You can simply ignore the applicative webhooks that are non-applicable to your backend.
Eva will automatically reply to end users explicitly requesting these services with a &#8220;not supported&#8221; message.</p>
</li>
<li><p class="first"><strong>Add more messaging platform integrations</strong></p>
<p>Repeat step 2 to provide additional messaging platform integrations.</p>
</li>
</ol>
</div>
<div class="section" id="chat-service-integrations">
<h2>3.2. Chat Service Integrations<a class="headerlink" href="#chat-service-integrations" title="Permalink to this headline">¶</a></h2>
<p>Here is the ever growing list of Chat Service integrations.</p>
<div class="section" id="telegram-integration">
<h3>3.2.1. Telegram integration<a class="headerlink" href="#telegram-integration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Create a new Telegram Bot</strong></p>
<p>Currently this can only be done by chatting with BotFather from within the Telegram application.
BotFather is available <a class="reference external" href="https://web.telegram.org/#/im?p=&#64;BotFather">Here</a></p>
<p>Tell him I sent you.</p>
<p>Create a new Bot by issuing the <strong>/newbot</strong> command.</p>
<p>Follow the in-app configuration instructions until the bot is created.
You will be provided with an HTTP API token such as &#8220;232021539:AAGGFCHb3dRCkOIi18Vscnu7T6bDzWcb_ro&#8221;</p>
</li>
<li><p class="first"><strong>Create a new Telegram Integration</strong></p>
<p>Head back to <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> and (after logging in if needed), click on the <strong>Add Chat Integration</strong> button.</p>
<p>Choose Type = Telegram.</p>
<p>Type in your Telegram HTTP API token.</p>
</li>
<li><p class="first"><strong>Say hi to Eva on Telegram!</strong></p>
<p>Now try chatting with your new bot in Telegram! Go ahead - try typing &#8220;hi&#8221; and &#8220;Who are you?&#8221;</p>
</li>
</ol>
</div>
<div class="section" id="line-integration">
<h3>3.2.2. Line integration<a class="headerlink" href="#line-integration" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>On September 29 LINE announced the release of Messaging API,
which will improve bot development and functionality as well as help better support developers.</p>
<p class="last"><strong>All BOT API Trial Accounts are scheduled to be deleted on November 16</strong>.</p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p class="first"><strong>Create a new Line Bot</strong></p>
<p>Create a Line messaging API account from the LINE Business Center.
You need to have a business account - <a class="reference external" href="https://business.line.me">https://business.line.me</a></p>
</li>
<li><p class="first"><strong>Create a new Line Integration</strong></p>
<p>Head back to <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> and (after logging in if needed), click on the <strong>Add Chat Integration</strong> button.</p>
<p>Choose Type = &#8220;Line - Messaging API&#8221;.</p>
<p>Fill in your Channel Secret and access token.</p>
</li>
<li><p class="first"><strong>Configure Eva as the Line Bot</strong></p>
<p>Set the Webhook URL to the value provided after saving the &#8220;Chat integration&#8221; in Botkit admin.</p>
</li>
<li><p class="first"><strong>Say hi to Eva on Line!</strong></p>
<p>Scan the QR code in Line Business center.
Now try chatting with your new bot in Line.
Go ahead - try typing &#8220;hi&#8221; and &#8220;Who are you?&#8221;</p>
</li>
</ol>
</div>
<div class="section" id="facebook-messenger-integration">
<h3>3.2.3. Facebook Messenger integration<a class="headerlink" href="#facebook-messenger-integration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Facebook Page and App</strong></p>
<p>Create a new Facebook App and Page or use existing ones.
Your Facebook App can remain in sandbox mode and your Page does NOT have to be publicly visible.
The Page profile pic and name will be used to form the &#8220;identity&#8221; of your bot and is what people will see when they engage it.
Please note your Page &#8220;Facebook Page ID&#8221;, e.g. 135827446828726</p>
<p>Go to your app settings and, under Product Settings, click &#8220;Add Product.&#8221; Select &#8220;Messenger.&#8221;
In the settings you will see a Token Generation section. Select your Page and copy the generated Page Access Token.</p>
</li>
<li><p class="first"><strong>Create a new Facebook Integration</strong></p>
<p>Head back to <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> and (after logging in if needed), click on the <strong>Add Chat Integration</strong> button.</p>
<p>Choose Type = Facebook.</p>
<p>Fill in the Page Access Token generated in the previous step.</p>
<p>Fill in your Facebook Page ID.</p>
<p>Click Save.</p>
</li>
<li><p class="first"><strong>Configure Eva as the Facebook bot</strong></p>
<p>After you create Facebook Integration you will be guided on screen to go back to your Facebook Admin and do the following:</p>
<p>Under the &#8220;PRODUCT SETTINGS&#8221; section, click on the &#8220;Messenger&#8221; product you just added,
find the Webhooks section and click Setup Webhooks.
Enter the following URL for a webhook - &#8220;<a class="reference external" href="https://chat.evature.com/fb">https://chat.evature.com/fb</a>&#8221;.</p>
<p>Enter the Verify Token that will shown in Botkit&#8217;s Admin.</p>
<p>Select all checkboxes under Subscription Fields, specifically: message_deliveries, message_echoes, message_reads, messages,
messaging_account_linking, messaging_optins, messaging_postbacks.</p>
<p>Verify and Save.</p>
<p>You should see a green checkmark with the text &#8220;Completed&#8221;.</p>
<p>In that same panel, Select your pages to subscribe your webhook to the page events in the &#8220;select a page&#8221; drop-down and
click &#8220;Subscribe&#8221;.</p>
</li>
<li><p class="first"><strong>Request Permissions for your app</strong></p>
<p>Under the &#8220;PRODUCT SETTINGS&#8221; section, click on the &#8220;Messenger&#8221; product you just added,
find the App Review for Messenger section and click Request Permissions.</p>
<p>Select pages_messaging</p>
<p>Click Add 1 Item</p>
</li>
<li><p class="first"><strong>Say hi to Eva on Facebook Messenger!</strong></p>
<p>Now try chatting with your new bot in Facebook Messenger. Go ahead - try typing &#8220;hi&#8221; and &#8220;Who are you?&#8221;</p>
</li>
</ol>
</div>
<div class="section" id="kik-integration">
<h3>3.2.4. Kik integration<a class="headerlink" href="#kik-integration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Create a new Kik Bot</strong></p>
<p>Using the Kik application scan the QR here - <a class="reference external" href="https://dev.kik.com/#/home">https://dev.kik.com/#/home</a></p>
<p>You will start a chat with Botsworth.</p>
<p>Note the Bot username from the chat with Botsworth.</p>
<p>Once the bot is created Botsworth will suggest to log you in to the Bot Dashboard.</p>
<p>In the configuration you will be able to see your API key, which looks like this: &#8220;e15ee13d-e84f-466e-b93e-d2c1eb0508f7&#8221;</p>
</li>
<li><p class="first"><strong>Create a new Kik Integration</strong></p>
<p>Head back to <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> and (after logging in if needed), click on the <strong>Add Chat Integration</strong> button.</p>
<p>Choose Type = Kik.</p>
<p>Fill in the username and API Key generated in the previous step.</p>
<p>Click Save.</p>
</li>
<li><p class="first"><strong>Say hi to Eva on Kik!</strong></p>
<p>Now try chatting with your new bot in Kik. Go ahead - try typing &#8220;hi&#8221; and &#8220;Who are you?&#8221;</p>
</li>
</ol>
</div>
<div class="section" id="skype-integration">
<h3>3.2.5. Skype integration<a class="headerlink" href="#skype-integration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Create a new Skype Bot</strong></p>
<p>You will need to register as a developer here:
<a class="reference external" href="https://www.skype.com/en/developer/">https://www.skype.com/en/developer/</a></p>
<p>Then head over to &#8220;register a bot&#8221; at <a class="reference external" href="https://dev.botframework.com/bots/new">https://dev.botframework.com/bots/new</a></p>
<p>In the Configuration / Messaging endpoint
please enter
&#8220;<a class="reference external" href="https://chat.evature.com/skype">https://chat.evature.com/skype</a>&#8221;
Press:
Create Microsoft App ID
Generate App ID and password
Make sure to copy the application ID and password!</p>
</li>
<li><p class="first"><strong>Create a new Skype Integration</strong></p>
<p>Head back to <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> and (after logging in if needed), click on the <strong>Add Chat Integration</strong> button.</p>
<p>Choose Type = Skype.</p>
<p>Type in your Skype App ID and App Secret (the password).</p>
</li>
<li><p class="first"><strong>Make sure your endpoint is configured correctly</strong></p>
<p>In the Bots page, <a class="reference external" href="https://dev.botframework.com/bots">https://dev.botframework.com/bots</a>
Under &#8220;Test connection to your bot&#8221;, press the <strong>Test</strong> button.
You should see: &#8220;Endpoint authorization succeeded&#8221;.</p>
</li>
<li><p class="first"><strong>Add your new bot to Skype</strong></p>
<p>In the <a class="reference external" href="https://dev.botframework.com/bots">https://dev.botframework.com/bots</a> page, in the Channels pane next to Skype,
press the <strong>Add to Skype</strong> button.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Skype Bots might not be available in your country yet.
You might have to workaround this by changing your billing address, or using a pre-release client,
such as this: <a class="reference external" href="https://community.skype.com/t5/Linux/Where-to-get-the-latest-Skype-for-Linux-Alpha/td-p/4536964">https://community.skype.com/t5/Linux/Where-to-get-the-latest-Skype-for-Linux-Alpha/td-p/4536964</a></p>
</div>
</li>
<li><p class="first"><strong>Say hi to Eva on Skype!</strong></p>
<p>Now try chatting with your new bot in Skype! Go ahead - try typing &#8220;hi&#8221; and &#8220;Who are you?&#8221;</p>
</li>
</ol>
</div>
</div>
<div class="section" id="applicative-webhooks">
<h2>3.3. Applicative Webhooks<a class="headerlink" href="#applicative-webhooks" title="Permalink to this headline">¶</a></h2>
<p>Here are the list of available applicative webhooks. The list is constantly being updated, based on the input data.
If you would like to add functionality please contact us directly at <a class="reference external" href="mailto:info&#37;&#52;&#48;evature&#46;com">info<span>&#64;</span>evature<span>&#46;</span>com</a></p>
<p>For each added webhook there is a demo implementation at <a class="reference external" href="https://github.com/evature/botkit-integrations">https://github.com/evature/botkit-integrations</a></p>
<p>Evature also provides a simple repository with super simple Python demos of webhook replies:  <a class="reference external" href="https://github.com/evature/webhooks">https://github.com/evature/webhooks</a></p>
<div class="section" id="general">
<h3>3.3.1. General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<p>All webhooks are HTTP/S POSTs with a JSON encoded body and expect a JSON formatted response.</p>
<p>Eva provides a standardized way to access all messaging providers so you don&#8217;t need to learn how to integrate with each one.
Eva does this by providing several generic formats of messages that can be returned by the applicative webhooks.
These formats are automatically matched to the native formats supported by each messaging platform:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Text:</th><td class="field-body">Simple text message</td>
</tr>
<tr class="field-even field"><th class="field-name">Image:</th><td class="field-body">Eva will handle format conversions, resizing and serving multiple resolutions dynamically</td>
</tr>
<tr class="field-odd field"><th class="field-name">RichMessage:</th><td class="field-body">Images with buttons, clickable URLs, Title and Subtitle, optionally grouped together horizontally</td>
</tr>
<tr class="field-even field"><th class="field-name">HTML:</th><td class="field-body">Eva will render the HTML to an image with the optimal screen setting for each messaging provider</td>
</tr>
<tr class="field-odd field"><th class="field-name">DataMessage:</th><td class="field-body">Template based pre-formatted messages that will render correctly across platforms</td>
</tr>
<tr class="field-even field"><th class="field-name">Raw:</th><td class="field-body">Properly formatted for the requested messaging provider</td>
</tr>
</tbody>
</table>
<p>In addition, Eva supports returning a list of messages, which will be sent to the end user one by one.</p>
<p>Webhooks deliver a <code class="docutils literal"><span class="pre">messagingProvider</span></code> key which signals the implementation where the request came from.
<code class="docutils literal"><span class="pre">messagingProvider</span></code> is an enumeration for the different messaging providers, one of the Chat Service Integrations.
This can be used by the implementation to provide unique, content specific content,
or to apply formatting when returning Raw messages.</p>
<p>Webhooks also deliver a globally unique <code class="docutils literal"><span class="pre">ChatKey</span></code>.
This allows the application to asynchronously send messages to the end user by POSTing the data to
<a class="reference external" href="https://chat.evature.com/send_botkit_message">https://chat.evature.com/send_botkit_message</a></p>
<p>When applicable, webhooks also deliver a <code class="docutils literal"><span class="pre">language</span></code> key. Value is a 2 character string with an ISO 639-1 code.
This allows the application to send messages using the correct language.</p>
<p>All DateTimes are in ISO 8601 format <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601">https://en.wikipedia.org/wiki/ISO_8601</a> .
DateTimes that are ranges (e.g. &#8216;next week&#8217;, or &#8216;July&#8217;) are expressed as a combination of 2 DateTimes - a &#8220;Min&#8221; and a &#8220;Max&#8221;.
DateTimes that are NOT ranges are expressed as a combination of 2 IDENTICAL DateTimes.</p>
<p>The Botkit will show a &#8216;Bot is typing&#8217; indication in platforms that support it. The inidication will be turned on before activating the webhook
and will be turned off when the webhook response is returned. To keep the typing indication turned on even after the webhook has returned,
pass <code class="docutils literal"><span class="pre">&quot;keepTyping&quot;:</span> <span class="pre">true</span></code> field in the response.</p>
<p>Here is the minimal webhook reply with a single text message:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Webhook Reply with single Text message</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span> <span class="c1">// Without this key the content is considered a Raw message and is passed as-is</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>When asynchronously sending messages to the end user by POSTing the data to <a class="reference external" href="https://chat.evature.com/send_botkit_message">https://chat.evature.com/send_botkit_message</a> ,
The <code class="docutils literal"><span class="pre">ChatKey</span></code> must be included in the reply:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Single Text message, sent asynchronously</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441c21&quot;</span><span class="p">,</span> <span class="c1">// Is Mandatory only when asynchronously sent</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Good Morning!&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is an example of returning a picture:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Webhook Reply with single Image message</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ImageMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-url.com/url-to-img&quot;</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is an HTML message response:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Webhook Reply with an HTML message</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span> <span class="c1">// Without this key the content is considered a Raw message and is passed as-is</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HtmlMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;height&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
      <span class="s2">&quot;width&quot;</span><span class="o">:</span> <span class="mi">350</span>
      <span class="s2">&quot;html&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;h1&gt;Hello World&lt;/h1&gt; &lt;strong&gt;This&lt;/strong&gt; &lt;small&gt;is&lt;/small&gt; &lt;em&gt;HTML&lt;/em&gt;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is a Rich message response:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Webhook Reply with an Rich message</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span> <span class="c1">// Without this key the content is considered a Raw message and is passed as-is</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://url-to-img.com/image.jpg&quot;</span><span class="p">,</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;The RichMessage Title&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subtitle&quot;</span><span class="o">:</span> <span class="s2">&quot;Subtitle will appear below the title (optional)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-clicked.com&quot;</span><span class="p">,</span>    <span class="c1">// optional - clicking the image will open webbrowser to this url</span>
      <span class="s2">&quot;buttons&quot;</span><span class="o">:</span> <span class="p">[</span>    <span class="c1">// optional</span>
          <span class="p">{</span><span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ButtonMessage&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;click to open webbrowser&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://button-pressed.com&quot;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is &#8220;MultiRich&#8221; message response - horizontally scrolled list of Rich messages:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Webhook Reply example with MultiRichMessage</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;MultiRichMessage&quot;</span><span class="p">,</span> <span class="s2">&quot;messages&quot;</span><span class="o">:</span><span class="p">[</span>
         <span class="p">{</span> <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span> <span class="p">...</span> <span class="nx">see</span> <span class="nx">above</span> <span class="p">...</span> <span class="p">},</span>
         <span class="p">{</span> <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span> <span class="p">...</span> <span class="nx">see</span> <span class="nx">above</span> <span class="p">...</span> <span class="p">},</span>
      <span class="p">]}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is a &#8220;DataMessage&#8221; template based response - for Flight Status:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Webhook Reply example with DataMessage - for Flight Status</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;DataMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subType&quot;</span><span class="o">:</span><span class="s2">&quot;airline_update&quot;</span><span class="p">,</span>
      <span class="s2">&quot;asAttachment&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
      <span class="s2">&quot;jsonData&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;flight_number&quot;</span><span class="o">:</span><span class="s2">&quot;UAL123&quot;</span><span class="p">,</span>
        <span class="s2">&quot;departure_airport&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;terminal&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="s2">&quot;London Heathrow&quot;</span><span class="p">,</span>
          <span class="s2">&quot;airport_code&quot;</span><span class="o">:</span><span class="s2">&quot;LHR&quot;</span><span class="p">,</span>
          <span class="s2">&quot;gate&quot;</span><span class="o">:</span><span class="s2">&quot;232&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;arrival_airport&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;terminal&quot;</span><span class="o">:</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
          <span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="s2">&quot;Washington Dulles Intl&quot;</span><span class="p">,</span>
          <span class="s2">&quot;airport_code&quot;</span><span class="o">:</span><span class="s2">&quot;IAD&quot;</span><span class="p">,</span>
          <span class="s2">&quot;gate&quot;</span><span class="o">:</span><span class="s2">&quot;C2&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;flight_schedule&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;departure_time_actual&quot;</span><span class="o">:</span><span class="s2">&quot;2016-08-09T08:16:00&quot;</span><span class="p">,</span>
          <span class="s2">&quot;arrival_time&quot;</span><span class="o">:</span><span class="s2">&quot;2016-08-09T10:51:00&quot;</span><span class="p">,</span>
          <span class="s2">&quot;departure_time&quot;</span><span class="o">:</span><span class="s2">&quot;2016-08-09T07:30:00&quot;</span><span class="p">,</span>
          <span class="s2">&quot;boarding_time&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;airline_name&quot;</span><span class="o">:</span><span class="s2">&quot;United&quot;</span><span class="p">,</span>
        <span class="s2">&quot;number&quot;</span><span class="o">:</span><span class="mi">123</span>
      <span class="p">},</span>
      <span class="s2">&quot;introMessage&quot;</span><span class="o">:</span><span class="s2">&quot;Here is an example of a Flight Status&quot;</span>
    <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>And here is a &#8220;DataMessage&#8221; template based response - for a Boarding Pass:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Webhook Reply example with DataMessage - for Boarding Pass</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span><span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;subType&quot;</span><span class="o">:</span><span class="s2">&quot;airline_boardingpass&quot;</span><span class="p">,</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;DataMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;asAttachment&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;jsonData&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;seat&quot;</span><span class="o">:</span><span class="s2">&quot;75A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;travel_class&quot;</span><span class="o">:</span><span class="s2">&quot;business&quot;</span><span class="p">,</span>
        <span class="s2">&quot;auxiliary_fields&quot;</span><span class="o">:</span><span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;T1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Terminal&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;30OCT 19:05&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Departure&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;qr_code&quot;</span><span class="o">:</span><span class="s2">&quot;M1WEISS\\/TAL  CG4X7U nawouehgawgnapwi3jfa0wfh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pnr_number&quot;</span><span class="o">:</span><span class="s2">&quot;CG4X7U&quot;</span><span class="p">,</span>
        <span class="s2">&quot;logo_image_url&quot;</span><span class="o">:</span><span class="s2">&quot;https://d2hbukybm05hyt.cloudfront.net/images/airline_logos/logo_JB.png&quot;</span><span class="p">,</span>
        <span class="s2">&quot;passenger_name&quot;</span><span class="o">:</span><span class="s2">&quot;TAL WEISS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;secondary_fields&quot;</span><span class="o">:</span><span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;18:30&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Boarding&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;D57&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Gate&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;75A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Seat&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span><span class="s2">&quot;003&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="o">:</span><span class="s2">&quot;Sec.Nr.&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;flight_info&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;arrival_airport&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="s2">&quot;Amsterdam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;airport_code&quot;</span><span class="o">:</span><span class="s2">&quot;AMS&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flight_schedule&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="s2">&quot;arrival_time&quot;</span><span class="o">:</span><span class="s2">&quot;2016-01-05T17:30&quot;</span><span class="p">,</span>
            <span class="s2">&quot;departure_time&quot;</span><span class="o">:</span><span class="s2">&quot;2016-01-02T19:05&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flight_number&quot;</span><span class="o">:</span><span class="s2">&quot;KL0642&quot;</span><span class="p">,</span>
          <span class="s2">&quot;departure_airport&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="s2">&quot;terminal&quot;</span><span class="o">:</span><span class="s2">&quot;T1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="s2">&quot;New York&quot;</span><span class="p">,</span>
            <span class="s2">&quot;airport_code&quot;</span><span class="o">:</span><span class="s2">&quot;JFK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gate&quot;</span><span class="o">:</span><span class="s2">&quot;D57&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;header_image_url&quot;</span><span class="o">:</span><span class="s2">&quot;https://d1hz6cg1a1lrv6.cloudfront.net/media/images/evature/logo4-19b0ca62fbf2b08e3bbc9d25298523ea4600422e.jpg&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;introMessage&quot;</span><span class="o">:</span><span class="s2">&quot;Here is an example of a Boarding Pass&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span><span class="s2">&quot;0.4.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here is a generic, all inclusive example of a webhook reply that is returned by the implementation:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Generic Webhook Reply</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;1234b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ImageMessage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://url-to-img.com/image.png&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;buttons&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ButtonMessage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;payload&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;1st button text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://button-pressed.com&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ButtonMessage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;2nd button text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://second-button-pressed.com&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-url.com/url-to-img&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subtitle&quot;</span><span class="o">:</span> <span class="s2">&quot;subtitle (optional)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;title (optional)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://on-click-url.com/(optional)&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HtmlMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;height&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
      <span class="s2">&quot;html&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;h1&gt;Hello World&lt;/h1&gt; &lt;strong&gt;This&lt;/strong&gt; &lt;small&gt;is&lt;/small&gt; &lt;em&gt;HTML&lt;/em&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;width&quot;</span><span class="o">:</span> <span class="mi">350</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;MultiRichMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;buttons&quot;</span><span class="o">:</span> <span class="p">[],</span>
          <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-url.com/url-to-img-1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;subtitle&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Image 1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="kc">null</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;buttons&quot;</span><span class="o">:</span> <span class="p">[],</span>
          <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-url.com/url-to-img-2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;subtitle&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Image 2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="kc">null</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;RichMessage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;buttons&quot;</span><span class="o">:</span> <span class="p">[],</span>
          <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://image-url.com/url-to-img-3&quot;</span><span class="p">,</span>
          <span class="s2">&quot;subtitle&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Image 3&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="kc">null</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="log-messages-between-eva-and-user">
<h3>3.3.2. Log Messages between Eva and User<a class="headerlink" href="#log-messages-between-eva-and-user" title="Permalink to this headline">¶</a></h3>
<p>Allows logging of all communication between Eva to the end user and helpful debug information regarding the integration.</p>
<p>Eva BotKit logs all activity to this Webhook as simple JSON HTTP POSTs.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>To set up a simple view for this log, head over to <a class="reference external" href="https://gomix.com/">https://gomix.com/</a></p>
<ul class="simple">
<li>Log in to GitHub.</li>
<li>Start a new project.</li>
<li>Click on the project name, <cite>Advanced Options</cite>, <cite>Import from Github</cite> and input &#8216;iftahh/bot_logger&#8217;.</li>
<li>Click on <cite>Show</cite> and you will see a scrolling list of logs from the BotKit.</li>
</ul>
<p class="last">Enter &#8220;Hi&#8221; to Eva in any messenger to see some logs.</p>
</div>
</div>
<div class="section" id="webhooks-health">
<h3>3.3.3. Webhooks health<a class="headerlink" href="#webhooks-health" title="Permalink to this headline">¶</a></h3>
<p>Please note that a webhook which fails for 5 consecutive times will be disabled.
Use the management UI at <a class="reference external" href="https://chat.evature.com/botkit">https://chat.evature.com/botkit</a> to re-enable.
Disabled webhooks will be colored red.</p>
</div>
<div class="section" id="session-storage">
<h3>3.3.4. Session Storage<a class="headerlink" href="#session-storage" title="Permalink to this headline">¶</a></h3>
<p>BotKit implements a server-side storage for developer convenience.
This is useful for keeping dialog state and known information about the end user (eg. his PNR number or home town),
and to avoid asking the end user the same questions again and again (&#8220;Do you like dogs?&#8221;).
An example scenario is asking the end user what her favorite hotel chain is in the implementation a hotel search webhook.
The next time she requests a hotel search the application can use the favorite hotel chain stored in the Session Storage.
Session Storage is a simple JSON object that is stored in Eva&#8217;s database per end user.
The sessions are stored forever with no timeout.</p>
<p>Each webhook payload will include the Session Storage (if it is non-empty) in the <code class="docutils literal"><span class="pre">session</span></code> key.</p>
<p>It is the responsibility of the webhook developers to handle the session, adding, modifying and removing information.
For example, you may wish to remove the dialog state after the dialog is complete or a long time has passed.</p>
<p>To remove/add/modify the contents of the Session Storage simply return the updated session in the webhook response <code class="docutils literal"><span class="pre">session</span></code> key.</p>
<p>To examine the session simply check if the webhook payload has a <code class="docutils literal"><span class="pre">session</span></code> key and if so examine its content.</p>
</div>
<div class="section" id="interactive-messages-general">
<h3>3.3.5. Interactive Messages - General<a class="headerlink" href="#interactive-messages-general" title="Permalink to this headline">¶</a></h3>
<p>There are several types of interactive messages that can be returned from the applicative webhooks.
These messages are instructions to the BotKit to interact with the end users.
The interactive message must be the last in the list of returned messages.
There can only be a single interactive message in the list of returned messages.</p>
<p>These are the types of interactive messages:</p>
<ul>
<li><p class="first">A Login request</p>
<p>The end user needs to log into your back-end before continuing the chat.</p>
</li>
<li><p class="first">A Question</p>
<p>Eva will ask the end user a question. Questions can be open, Yes / No and Multiple Choice.</p>
</li>
<li><p class="first">Validate Email</p>
</li>
<li><p class="first">Validate Phone Number</p>
</li>
<li><p class="first">Transfer the chat to a Human Agent</p>
</li>
<li><p class="first">Subscription management of Group Notifications</p>
</li>
</ul>
</div>
<div class="section" id="interactive-message-logging-in-end-users-oauth">
<h3>3.3.6. Interactive Message - Logging In End Users - OAuth<a class="headerlink" href="#interactive-message-logging-in-end-users-oauth" title="Permalink to this headline">¶</a></h3>
<p>When a user starts a conversation with your business, you may want to identify her as a customer who already has
an account with your business. To help with this, we have created a platform-agnostic secured protocol to link and unlink
the messaging end-user identity with your business user identity.</p>
<p>OAuth-style LogIn allows you to invite users to log-in using your existing authentication flow thus to provide a more secure,
personalized and relevant experience to users.</p>
<p>To request a Log In return a special message of type <cite>LoginOAuthEvent</cite> from any applicative webhook.
As this is an interactive message it can only be the last in the list of returned messages
and there can only be a single interactive message in the list.</p>
<p>Here is an example of such a reply:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">OAuth LogIn Reply Example</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;LoginOAuthEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;loginSuccessHook&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;webhook&quot;</span><span class="o">:</span> <span class="s2">&quot;flight_boarding_pass&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Please Login in first&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLoginUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;https://chat.evature.com/demo_login&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">_type:</th><td class="field-body">Must be &#8220;LoginOAuthEvent&#8221;</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">loginSuccessHook:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">a JSON object with either <cite>webhook</cite> - an enumeration of an existing webhook, or <cite>url</cite></td>
</tr>
<tr class="field-odd field"><th class="field-name">text:</th><td class="field-body">any text message - mandatory.</td>
</tr>
<tr class="field-even field"><th class="field-name">webLoginUrl:</th><td class="field-body">a URL to the web login page.</td>
</tr>
</tbody>
</table>
<p>The end user will be presented with a log in request. Once she clicks on it she will be redirected outside the messaging platform
and into the a web browser window with the business specific log in process.</p>
<p>The URL <cite>webLoginUrl</cite> will be extended with a query parameter called <cite>redirect_uri</cite>.
If the log in is successful, redirect the browser to the <cite>redirect_uri</cite> specified in your callback to complete the flow,
and append a new <cite>authorization_code</cite> query parameter. Eva will add the contents of <cite>authorization_code</cite> to the subsequent
applicative webhook calls as a new key called <code class="docutils literal"><span class="pre">loginData</span></code>.</p>
</div>
<div class="section" id="interactive-message-transfer-chat-to-a-human-agent">
<h3>3.3.7. Interactive Message - Transfer chat to a Human Agent<a class="headerlink" href="#interactive-message-transfer-chat-to-a-human-agent" title="Permalink to this headline">¶</a></h3>
<p>When this message is returned from an applicative webhook, Eva will attempt to transfer the chat to a human agent.
This assumes that an Agency of Human Agents has been set up in advance. The message looks like this:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Transfer Chat to Human Agent Reply Example</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HandoffToHumanEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;noAgentsOnlineText&quot;</span><span class="o">:</span> <span class="s2">&quot;text to display when no agents are online (if not using noAgentsOnlineHook)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;agentsOnlineText&quot;</span><span class="o">:</span> <span class="s2">&quot;Text to display&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">noAgentsOnlineText:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">an optional text to be displayed</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">agentsOnlineText:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">an optional text to be displayed</td>
</tr>
</tbody>
</table>
<p>To request a Human Agent Transfer return a special message of type <cite>HandoffToHumanEvent</cite> from any applicative webhook.
As this is an interactive message it can only be the last in the list of returned messages
and there can only be a single interactive message in the list.</p>
<p>If there are no relevant agents online the end user sees a default &#8220;Sorry, no agents are online&#8221; message.</p>
<p>If there are agents online, Eva shows the end user a choice of available chat topics.
Chat topics are configured in the EvaChat Admin page. Only chat topics which have matching agents online are shown.
When the user makes a Chat Topic choice the chat is transferred and the user sees &#8220;Please wait while an agent joins&#8221;
followed (eventually) by &#8220;Agent [name] has joined&#8221;.</p>
<p>The application can configure what happens when there are no agents online by returning the following optional parameter key:
&#8220;noAgentsOnlineHook&#8221;. The content of this key is either a wehbook enumeration or a url.
This follow-up webhook is activated instead of showing the default &#8220;Sorry, no agents are online&#8221;
allowing that webhook to return a custom reply (e.g. present a phone number, and/or working hours).</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Specify no agents behavior with Webhook Reply Example</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HandoffToHumanEvent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;noAgentsOnlineHook&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;webhook&quot;</span><span class="o">:</span> <span class="s2">&quot;contact_support&quot;</span><span class="p">,</span>
    <span class="s2">&quot;payload&quot;</span><span class="o">:</span>  <span class="p">{</span><span class="s2">&quot;whatever_payload_here&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">payload:</th><td class="field-body">an optional payload that will be delivered to the webhook</td>
</tr>
</tbody>
</table>
<p>or alternatively:</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Specify no agents behavior with URL Reply Example</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HandoffToHumanEvent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;noAgentsOnlineHook&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https://my-server.com/no_agents_online/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;payload&quot;</span><span class="o">:</span>  <span class="p">{</span><span class="s2">&quot;whatever_payload_here&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The application may wish to skip the choosing of Chat Topic by returning the &#8220;chooseTopic&#8221; optional key parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">chooseTopic:</th><td class="field-body">An optional string that MUST match one of the pre-configured chat-topics</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Specify Chat Topic Reply Example</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HandoffToHumanEvent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chooseTopic&quot;</span><span class="o">:</span>  <span class="s2">&quot;Existing Booking&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>When the <code class="docutils literal"><span class="pre">chooseTopic</span></code> parameter is specified the chat topic is chosen without presenting the choices to the user.
The end user immediately sees either the &#8220;Please wait while an agent joins&#8221; or the &#8220;Sorry, no agents are online&#8221; messages.
This functionality is useful in cases when the handoff-to-human is activated from a webhook which already narrowed down
the chat topic, for example the <cite>change_booking</cite> webhook may hand-off to a human with a chat topic of &#8220;Existing Booking&#8221;.</p>
</div>
<div class="section" id="interactive-message-subscribe-to-list">
<h3>3.3.8. Interactive Message - Subscribe to List<a class="headerlink" href="#interactive-message-subscribe-to-list" title="Permalink to this headline">¶</a></h3>
<p>Eva supports subscription list management for multicast notifications.
To subscribe end users to a new or existing subscriptions list
return the following interactive message from any applicative webhook:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Subscribe to List Reply Example</span><a class="headerlink" href="#id15" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;SubscribeEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Would you like to receive updates for this flight?&quot;</span><span class="p">,</span>
      <span class="s2">&quot;buttonText&quot;</span><span class="o">:</span> <span class="s2">&quot;Subscribe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subscriptionId&quot;</span><span class="o">:</span> <span class="s2">&quot;A unique name for this subscription&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>As this is an interactive message it can only be the last in the list of returned messages
and there can only be a single interactive message in the list.</p>
</div>
<div class="section" id="interactive-message-questionnaires">
<h3>3.3.9. Interactive Message - questionnaires<a class="headerlink" href="#interactive-message-questionnaires" title="Permalink to this headline">¶</a></h3>
<p>questionnaires are the ChatBot equivalent of forms,
where user interaction is better served with simple UI elements such as buttons.
A questionnaire is a list of questions of various types that Eva will ask the end user.
As a questionnaire is an interactive message it can only be the last in the list of returned messages
and there can only be a single interactive message in the list.</p>
<p>To request asking the end user questions,
return the following interactive message from any applicative webhook:</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">Example of questionnaire</span><a class="headerlink" href="#id16" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span><span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span><span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;QuestionnaireEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;questionnaireAnsweredHook&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;webhook&quot;</span><span class="o">:</span><span class="s2">&quot;roadside_assistance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;more_info_to_attach_to_answers&quot;</span><span class="o">:</span><span class="mi">123</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;questionnaireAbortedHook&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;webhook&quot;</span><span class="o">:</span><span class="s2">&quot;roadside_assistance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="o">:</span><span class="p">{</span>
          <span class="s2">&quot;validation error?&quot;</span><span class="o">:</span><span class="mi">321</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;questions&quot;</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;EmailQuestion&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="s2">&quot;email&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span><span class="s2">&quot;I need to identify you, what is your email?&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;MultiChoiceQuestion&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span><span class="s2">&quot;What happened?&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="s2">&quot;what_happened&quot;</span><span class="p">,</span>
          <span class="s2">&quot;choices&quot;</span><span class="o">:</span><span class="p">[</span>
            <span class="s2">&quot;Accident&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mechanical problem&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Other&quot;</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span><span class="s2">&quot;OpenQuestion&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="s2">&quot;details&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span><span class="s2">&quot;I need a string that starts with &#39;a&#39; and is 3 or more letters&quot;</span><span class="p">,</span>
          <span class="s2">&quot;validationRegex&quot;</span><span class="o">:</span><span class="s2">&quot;a.{2}&quot;</span><span class="p">,</span>
          <span class="s2">&quot;validationFailText&quot;</span><span class="o">:</span> <span class="s2">&quot;Sorry, must be start with &#39;a&#39; or more letters.&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The &#8220;_type&#8221; of the message is always: &#8220;QuestionnaireEvent&#8221;</p>
<p>&#8220;questionnaireAnsweredHook&#8221; is an must contain &#8220;url&#8221; or &#8220;webhook&#8221; which enumeration of the webhook to call when the questions have all been answered.
&#8220;payload&#8221; is an object that will be added to the payload of the &#8220;questionnaireAnsweredHook&#8221;.</p>
<p>&#8220;questionnaireAbortedHook&#8221; has the same structure of a &#8220;questionnaireAnsweredHook&#8221;.
A &#8220;questionnaireAbortedHook&#8221; will be called if the validation of an &#8220;OpenQuestion&#8221; fails two times, or if the user requests to cancel.
This key is optional.</p>
<p>Send 1 or more questions, of any of the supported types in the list of &#8220;questions&#8221;.
In this example there are 3 questions.
Each question has a &#8220;name&#8221; which will be the key of the result in the payload to be delivered to the &#8220;questionnaireAnsweredHook&#8221;.</p>
<p>The 1st question in the example is an EmailQuestion.
The open reply will be validated using a built-in regular expression for email addresses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Eva will then send out an email to the designated address to make sure the submitted email is valid and owned by the end user!</p>
</div>
<p>The 2nd question in the example is a multiple choice question, typed &#8220;MultiChoiceQuestion&#8221; with 3 choices.
You can also optionally add <cite>&#8220;allowOther&#8221;: true</cite> which will tell the Botkit to accept an answer that isn&#8217;t one of the choices.</p>
<p>The 3rd question in the example is an open question for which you may request a validation regular expression.</p>
<p>If, for example you send:</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">Example of questionnaire  (with comments)</span><a class="headerlink" href="#id17" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuestionnaireEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;questionnaireAnsweredHook&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https://seed-gem.gomix.me/questionnaire_answered&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="o">:</span> <span class="p">{</span>                  <span class="cm">/*  optional */</span>
          <span class="s2">&quot;something_extra&quot;</span><span class="o">:</span> <span class="mi">12345</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;questionnaireAbortedHook&quot;</span><span class="o">:</span> <span class="p">{</span>  <span class="cm">/*  optional */</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https://seed-gem.gomix.me/questionnaire_aborted&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="o">:</span> <span class="p">{</span>                 <span class="cm">/* optional */</span>
          <span class="s2">&quot;some_other_thing&quot;</span><span class="o">:</span> <span class="mi">7890</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;questions&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;OpenQuestion&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;What is your last name?&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;validationRegex&quot;</span><span class="o">:</span> <span class="s2">&quot;\\S{3,}&quot;</span><span class="p">,</span>   <span class="cm">/*  optional */</span>
          <span class="s2">&quot;validationFailText&quot;</span><span class="o">:</span> <span class="s2">&quot;Name must be 3 or more letters.&quot;</span>  <span class="cm">/*  optional */</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;OpenQuestion&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;What is your first name?&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;first_name&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;MultiChoiceQuestion&quot;</span><span class="p">,</span>   <span class="cm">/*  present quick-respones of answers (limited by 20 chars per choice) */</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;favorite_color&quot;</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;What is your favorite color?&quot;</span><span class="p">,</span>
          <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;Red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Yellow&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;allowOther&quot;</span><span class="o">:</span> <span class="kc">true</span>    <span class="cm">/*  optional - if true it will accept an answer that is not one of the choices */</span>
                                <span class="cm">/* also you can add validationRegex,  validationFailText */</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Botkit will present the questions and finally send to the questionnaireAnsweredHook the following JSON  (comments in blue):</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">questionnaireAnsweredHook input (with comments)</span><a class="headerlink" href="#id18" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="cm">/* this is the result of the questionnaire   (key is the question name,  value is the answer by the user) */</span>
  <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span>
  <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Jones&quot;</span><span class="p">,</span>
  <span class="s2">&quot;favorite_color&quot;</span><span class="o">:</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
  <span class="s2">&quot;something_extra&quot;</span><span class="o">:</span> <span class="mi">12345</span><span class="p">,</span>
<span class="cm">/* below this is the usual payload of webhook input */</span>
  <span class="s2">&quot;language&quot;</span><span class="o">:</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;e62e9088-b6a3-4310-9d9a-1371aebae3c8&quot;</span><span class="p">,</span>
  <span class="s2">&quot;providerID&quot;</span><span class="o">:</span> <span class="s2">&quot;1749750371937776&quot;</span><span class="p">,</span>
  <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;lastName&quot;</span><span class="o">:</span> <span class="s2">&quot;Jones&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstName&quot;</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>In case the user aborts the questionnaire - either by answering an invalid answer multiple times, or in case he requests to cancel  (eg. types something along &#8220;start over&#8221;, &#8220;cancel&#8221;, etc..)
the questionnaireAbortedHook will be called.</p>
<p>If the user repeatedly answered invalid question, the hook will be called with a JSON similar to -</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">questionnaireAbortedHook input (with comments)</span><a class="headerlink" href="#id19" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastQuestionIndex&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;lastQuestionName&quot;</span><span class="o">:</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastAnswer&quot;</span><span class="o">:</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>
  <span class="s2">&quot;some_other_thing&quot;</span><span class="o">:</span> <span class="mi">7890</span><span class="p">,</span>
  <span class="s2">&quot;abortedSayIt&quot;</span><span class="o">:</span> <span class="s2">&quot;Please try again later.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;abortedReason&quot;</span><span class="o">:</span> <span class="s2">&quot;Multiple invalid answers&quot;</span><span class="p">,</span>
<span class="cm">/* below this is the usual payload of webhook input */</span>
  <span class="s2">&quot;language&quot;</span><span class="o">:</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;e62e9088-b6a3-4310-9d9a-1371aebae3c8&quot;</span><span class="p">,</span>
  <span class="s2">&quot;providerID&quot;</span><span class="o">:</span> <span class="s2">&quot;1749750371937776&quot;</span><span class="p">,</span>
  <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;lastName&quot;</span><span class="o">:</span> <span class="s2">&quot;Jones&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstName&quot;</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>If the user requested to start over, the hook will be called with a JSON similar to -</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">questionnaireAbortedHook input (with comments)</span><a class="headerlink" href="#id20" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="s2">&quot;start over&quot;</span><span class="p">,</span>
  <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Jones&quot;</span><span class="p">,</span>
  <span class="s2">&quot;some_other_thing&quot;</span><span class="o">:</span> <span class="mi">7890</span><span class="p">,</span>
  <span class="s2">&quot;abortedSayIt&quot;</span><span class="o">:</span> <span class="s2">&quot;Ok&quot;</span><span class="p">,</span>
  <span class="s2">&quot;abortedReason&quot;</span><span class="o">:</span> <span class="s2">&quot;Other action requested: chat_greeting&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastAnswer&quot;</span><span class="o">:</span> <span class="s2">&quot;start over&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastQuestionIndex&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;lastQuestionName&quot;</span><span class="o">:</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span>
<span class="cm">/* below this is the usual payload of webhook input */</span>
  <span class="s2">&quot;language&quot;</span><span class="o">:</span> <span class="s2">&quot;en&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;e62e9088-b6a3-4310-9d9a-1371aebae3c8&quot;</span><span class="p">,</span>
  <span class="s2">&quot;providerID&quot;</span><span class="o">:</span> <span class="s2">&quot;1749750371937776&quot;</span><span class="p">,</span>
  <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;lastName&quot;</span><span class="o">:</span> <span class="s2">&quot;Haimovitch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstName&quot;</span><span class="o">:</span> <span class="s2">&quot;Iftah&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-message-quick-replies">
<h3>3.3.10. Interactive Message - Quick Replies<a class="headerlink" href="#interactive-message-quick-replies" title="Permalink to this headline">¶</a></h3>
<p>Quick replies are an interactive message requesting input from the end user
(hence, it must be the last message in the list of messages).
It is presented to the user as buttons or a special keyboard, depending on the messaging platform.</p>
<div class="figure align-center">
<img alt="Simple Quick Replies" src="_images/Screenshot1.png" />
</div>
<p>Here is the simplest Quick Reply message:</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">Simple Quick Replies Example</span><a class="headerlink" href="#id21" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span> <span class="c1">// Without this key the content is considered a Raw message and is passed as-is</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuickRepliesEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;How much is 2+3?&quot;</span><span class="p">,</span>
      <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>When the button is pressed, the text that is displayed is sent off to Eva for Natural Language Understanding
and continuing the dialog, while the buttons are removed from the display.
Button texts have different length limitations on each of the platforms, for example a 20 character limit on Facebook Messenger.</p>
<p>The string list in the <code class="docutils literal"><span class="pre">choices</span></code> key is a simplification.
Here is a more generic, slightly more verbose approach which enables displaying a different text on the button
than the text that ends up being sent to Eva (the string value of the <code class="docutils literal"><span class="pre">inputText</span></code> key).</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">Simple Quick Replies Example #2</span><a class="headerlink" href="#id22" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuickRepliesEvent&quot;</span><span class="p">,</span>
            <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;InputTextAction&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;inputText&quot;</span><span class="o">:</span> <span class="s2">&quot;This is cool&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;This is cool&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;InputTextAction&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;inputText&quot;</span><span class="o">:</span> <span class="s2">&quot;Tell me a joke&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;A surprise&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;how awesome am I?&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>This functionality is achieved by an <code class="docutils literal"><span class="pre">Action</span></code> of type <code class="docutils literal"><span class="pre">InputTextAction</span></code>.
Here are a few more actions you can provided as choices for Quick Reply messages.</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">Simple Quick Replies Example #3</span><a class="headerlink" href="#id23" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuickRepliesEvent&quot;</span><span class="p">,</span>
            <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;HandoffToHumanChooseTopicAction&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;noAgentsOnlineText&quot;</span><span class="o">:</span> <span class="s2">&quot;Sorrrrry! no agents online! (optional)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;topic&quot;</span><span class="o">:</span> <span class="s2">&quot;Other&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;waitForAgentText&quot;</span><span class="o">:</span> <span class="s2">&quot;Let me check if someone is available (optional)&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;HUMAN - NOW!&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;OutputMessagesAction&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;I don&#39;t really DO anything, but here is a fish&quot;</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ImageMessage&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://pngimg.com/upload/fish_PNG10538.png&quot;</span>
                            <span class="p">}</span>
                        <span class="p">]</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Just &#39;print&#39; stuff&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;What would you like me to do?&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>A <code class="docutils literal"><span class="pre">HandoffToHumanChooseTopicAction</span></code> will try to handoff the conversation to a human representative, if available.
You can customize the texts and choose the topic of the conversation.</p>
<p>An <code class="docutils literal"><span class="pre">OutputMessagesAction</span></code> is simply a list of messages, which will be printed to the chat.</p>
<p>Here are a few more examples:</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text">Simple Quick Replies Example #4</span><a class="headerlink" href="#id24" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuickRepliesEvent&quot;</span><span class="p">,</span>
            <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;PostbackAction&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;webhookEnum&quot;</span><span class="o">:</span> <span class="s2">&quot;flight_arrival_time&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Postback example&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;SubscribeAgreedAction&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;subscribeId&quot;</span><span class="o">:</span> <span class="s2">&quot;test123&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;onSubscribeText&quot;</span><span class="o">:</span> <span class="s2">&quot;You are now subscribed!&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;M-cast subscription&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;What would you like me to do?&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>A <code class="docutils literal"><span class="pre">PostbackAction</span></code> will, upon the end user clicking on this button call the requested webhook,
to allow the application to implement a &#8220;flow&#8221;, or a state machine.</p>
<p>Here is the list of available webhook enumerations:</p>
<ul class="simple">
<li>search_flight</li>
<li>search_car</li>
<li>search_hotel</li>
<li>search_cruise</li>
<li>chat_greeting</li>
<li>flight_gate_number</li>
<li>flight_departure_time</li>
<li>flight_arrival_time</li>
<li>flight_boarding_time</li>
<li>flight_boarding_pass</li>
<li>flight_itinerary</li>
<li>logout</li>
<li>roadside_assistance</li>
<li>reservation_cancel</li>
<li>flight_status</li>
<li>contact_support</li>
<li>airport_navigation</li>
<li>change_booking</li>
<li>arrivals</li>
<li>departures</li>
<li>show_hotel</li>
<li>show_help</li>
<li>reservation_show</li>
<li>ask_time</li>
<li>ask_weather</li>
<li>book_hotel_room</li>
<li>capabilities</li>
<li>message_logger</li>
<li>room_checkin</li>
<li>flight_checkin</li>
<li>who_are_you</li>
<li>who_made_you</li>
<li>how_are_you</li>
<li>whats_your_name</li>
<li>where_are_you</li>
<li>unconfigured_webhook</li>
<li>misunderstanding</li>
<li>baggage</li>
<li>collect_user_information</li>
<li>select_credit_card</li>
<li>low_confidence</li>
</ul>
<p>A <code class="docutils literal"><span class="pre">PostbackAction</span></code> can accept a generic <code class="docutils literal"><span class="pre">url</span></code> key <strong>instead</strong> of the <code class="docutils literal"><span class="pre">webhookEnum</span></code> key.
Regardless of which you use, this action also has an optional <code class="docutils literal"><span class="pre">payload</span></code> key,
which can take either a JSON object <strong>or</strong> JSON encoded in a string.</p>
<p>A <code class="docutils literal"><span class="pre">SubscribeAgreedAction</span></code> adds the user to a subscription list for multicast pushes, as described in
<a class="reference internal" href="#label-for-inverse-webhooks"><span class="std std-ref">Inverse Webhooks</span></a>.</p>
<p>The <cite>subscribeId</cite> field is a mandatory string, while the <cite>onSubscribeText</cite> field is an optional one that will be displayed to the
end user as a text message upon subscription.</p>
<p>We can even change the language of the chat:</p>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text">Simple Quick Replies Example #4</span><a class="headerlink" href="#id25" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;QuickRepliesEvent&quot;</span><span class="p">,</span>
      <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;What would you like me to do?&quot;</span><span class="p">,</span>
      <span class="s2">&quot;choices&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;SetChatLanguageAction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;afterSetAction&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;OutputMessagesAction&quot;</span><span class="p">,</span>
              <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;All set for Norwegian!&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;language&quot;</span><span class="o">:</span> <span class="s2">&quot;no&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Lang -&gt; Norwegian 🇳🇴&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;SetChatLanguageAction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;afterSetAction&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;OutputMessagesAction&quot;</span><span class="p">,</span>
              <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;All set for English!&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;language&quot;</span><span class="o">:</span> <span class="s2">&quot;en&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Lang -&gt; English 🇺🇸&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The <cite>SetChatLanguageAction</cite> changes the language of the chat, where <cite>language</cite> is a 2 character ISO 639-1 key.
<cite>afterSetAction</cite> is an <strong>optional</strong> action following the language setup.</p>
</div>
</div>
<div class="section" id="specific-webhooks">
<h2>3.4. Specific Webhooks<a class="headerlink" href="#specific-webhooks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="search-for-flights">
<h3>3.4.1. Search for Flights<a class="headerlink" href="#search-for-flights" title="Permalink to this headline">¶</a></h3>
<p>When the dialog with the end user is done and Eva has all the required information the flight search webhook is triggered.
Here is an example of a flight search request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>User: &quot;fly from London to Moscow on Tuesday for 3 adults redeye and return 3 days later&quot;
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id26">
<div class="code-block-caption"><span class="caption-text">Flight Search Request Example</span><a class="headerlink" href="#id26" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;redeye&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="s2">&quot;twoWay&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
 <span class="s2">&quot;departDateMax&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-05-31T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;departDateMin&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-05-31T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;returnDateMax&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-06-03T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;returnDateMin&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-06-03T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;origin&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;airports&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;LHR&quot;</span><span class="p">,</span> <span class="s2">&quot;LGW&quot;</span><span class="p">,</span> <span class="s2">&quot;LCY&quot;</span><span class="p">,</span> <span class="s2">&quot;STN&quot;</span><span class="p">],</span>
            <span class="s2">&quot;allAirportsCode&quot;</span><span class="o">:</span> <span class="s2">&quot;LON&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="mi">2643743</span><span class="p">,</span>
            <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">51.50853</span><span class="p">,</span>
            <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.12574</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;London, United Kingdom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;City&quot;</span><span class="p">},</span>
 <span class="s2">&quot;destination&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;airports&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;SVO&quot;</span><span class="p">,</span> <span class="s2">&quot;DME&quot;</span><span class="p">,</span> <span class="s2">&quot;VKO&quot;</span><span class="p">,</span> <span class="s2">&quot;BKA&quot;</span><span class="p">],</span>
                 <span class="s2">&quot;allAirportsCode&quot;</span><span class="o">:</span> <span class="s2">&quot;MOW&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="mi">524901</span><span class="p">,</span>
                 <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">55.75222</span><span class="p">,</span>
                 <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="mf">37.61556</span><span class="p">,</span>
                 <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Moscow, Russia&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;City&quot;</span><span class="p">},</span>
 <span class="s2">&quot;travelers&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;adult&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<p>allAirportsCode is a key that exists only for cities that have a special IATA code for searching all-airports.</p>
</div>
<div class="section" id="search-for-hotels">
<h3>3.4.2. Search for Hotels<a class="headerlink" href="#search-for-hotels" title="Permalink to this headline">¶</a></h3>
<p>When the dialog with the end user is done and Eva has all the required information the hotel search webhook is triggered.
Here is an example of a hotel search request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>User: &quot;3 to 4 star Hilton in paris tomorrow 5 nights sort by price ascending for 2 adults and 3 kids&quot;
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id27">
<div class="code-block-caption"><span class="caption-text">Hotel Search Request Example</span><a class="headerlink" href="#id27" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;arriveDate&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-05-31T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;duration&quot;</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
 <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;chain&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Hilton Hotels&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;evaCode&quot;</span><span class="o">:</span> <span class="s2">&quot;EPC-47&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;gdsCode&quot;</span><span class="o">:</span> <span class="s2">&quot;HH&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;simpleName&quot;</span><span class="o">:</span> <span class="s2">&quot;Hilton&quot;</span><span class="p">}],</span>
                <span class="s2">&quot;quality&quot;</span><span class="o">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
 <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;airports&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;CDG&quot;</span><span class="p">,</span> <span class="s2">&quot;ORY&quot;</span><span class="p">,</span> <span class="s2">&quot;BVA&quot;</span><span class="p">,</span> <span class="s2">&quot;LIL&quot;</span><span class="p">],</span>
              <span class="s2">&quot;allAirportsCode&quot;</span><span class="o">:</span> <span class="s2">&quot;PAR&quot;</span><span class="p">,</span>
              <span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="mi">2988507</span><span class="p">,</span>
              <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">48.85341</span><span class="p">,</span>
              <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="mf">2.3488</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Paris, France&quot;</span><span class="p">,</span>
              <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;City&quot;</span><span class="p">},</span>
 <span class="s2">&quot;sortBy&quot;</span><span class="o">:</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span>
 <span class="s2">&quot;sortOrder&quot;</span><span class="o">:</span> <span class="s2">&quot;ascending&quot;</span><span class="p">,</span>
 <span class="s2">&quot;travelers&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;adult&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">}}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="search-for-cars">
<h3>3.4.3. Search for Cars<a class="headerlink" href="#search-for-cars" title="Permalink to this headline">¶</a></h3>
<p>When the dialog with the end user is done and Eva has all the required information the car rental search webhook is triggered.
Here is an example of a car rental search request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>User: &quot;rent an SUV with a GPS from JFK tomorrow morning return in 3 days&quot;
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id28">
<div class="code-block-caption"><span class="caption-text">Car Search Request Example</span><a class="headerlink" href="#id28" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;carType&quot;</span><span class="o">:</span> <span class="s2">&quot;Standard SUV&quot;</span><span class="p">,</span> <span class="s2">&quot;GPS&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
 <span class="s2">&quot;destination&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;airports&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;JFK&quot;</span><span class="p">],</span>
                 <span class="s2">&quot;allAirportsCode&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                 <span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="s2">&quot;JFK&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">40.633333</span><span class="p">,</span>
                 <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mf">73.783333</span><span class="p">,</span>
                 <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="nx">u</span><span class="s2">&quot;&#39;JFK&#39; = John F Kennedy Intl, US&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Airport&quot;</span><span class="p">},</span>
 <span class="s2">&quot;origin&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;airports&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;JFK&quot;</span><span class="p">],</span>
            <span class="s2">&quot;allAirportsCode&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="s2">&quot;JFK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">40.633333</span><span class="p">,</span>
            <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mf">73.783333</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="nx">u</span><span class="s2">&quot;&#39;JFK&#39; = John F Kennedy Intl, US&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Airport&quot;</span><span class="p">},</span>
 <span class="s2">&quot;pickupDate&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-05-31T08:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;returnDate&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-06-03T00:00:00&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="search-for-cruises">
<h3>3.4.4. Search for Cruises<a class="headerlink" href="#search-for-cruises" title="Permalink to this headline">¶</a></h3>
<p>When the dialog with the end user is done and Eva has all the required information the cruise search webhook is triggered.
Here is an example of a cruise search request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>User: &quot;cruise to Alaska in the summer with Carnival&quot;
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-text">Cruise Request Example</span><a class="headerlink" href="#id29" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;cruiseline&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Carnival Cruises&quot;</span><span class="p">}]},</span>
 <span class="s2">&quot;dateFrom&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-06-01T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;dateTo&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-08-30T00:00:00&quot;</span><span class="p">,</span>
 <span class="s2">&quot;durationMin&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
 <span class="s2">&quot;durationMax&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
 <span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;to&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;geoid&quot;</span><span class="o">:</span> <span class="mi">5879092</span><span class="p">,</span>
        <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="mf">64.00028</span><span class="p">,</span>
        <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mf">150.00028</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Alaska, United States&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;State&quot;</span><span class="p">}}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="greet-the-user">
<h3>3.4.5. Greet the User:<a class="headerlink" href="#greet-the-user" title="Permalink to this headline">¶</a></h3>
<p>Override the greeting to the user.
Eva calls this webhook with information about the scenario encoded in a key called <code class="docutils literal"><span class="pre">greeting_type</span></code>.
The values of this key is one of the following enumeration:</p>
<dl class="docutils">
<dt>existing_user_sent_from_webpage</dt>
<dd>After clicking &#8220;send to messenger&#8221; button - for a returning user</dd>
<dt>new_user_sent_from_webpage</dt>
<dd>After clicking &#8220;send to messenger&#8221; button - for a first time user</dd>
<dt>new_user</dt>
<dd>First time ever that the user sends a message to the Bot</dd>
<dt>requested_by_user</dt>
<dd>User requested, eg. typed &#8220;Start over&#8221;</dd>
<dt>new_chat_after_idle</dt>
<dd>Eva session timeout,</dd>
<dt>new_chat_after_terminated_by_agent</dt>
<dd>First message after terminating chat by Agent</dd>
</dl>
<p>Here is an example of an outgoing webhook payload greeting request:</p>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-text">Greeting Request Example</span><a class="headerlink" href="#id30" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span><span class="s2">&quot;01437b93-7089-418c-8beb-269951fae9c8&quot;</span><span class="p">,</span>
  <span class="s2">&quot;providerID&quot;</span><span class="o">:</span><span class="s2">&quot;312333852447351&quot;</span><span class="p">,</span>
  <span class="s2">&quot;greeting_type&quot;</span><span class="o">:</span><span class="s2">&quot;new_chat_after_terminated_by_agent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span><span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
  <span class="s2">&quot;user&quot;</span><span class="o">:</span><span class="p">{</span>
    <span class="s2">&quot;lastName&quot;</span><span class="o">:</span><span class="s2">&quot;Weiss&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstName&quot;</span><span class="o">:</span><span class="s2">&quot;Tal&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>As usual, you can reply with a list of messages, such as text messages, image messages and even interacive messages.</p>
</div>
<div class="section" id="display-gate-number">
<h3>3.4.6. Display Gate Number<a class="headerlink" href="#display-gate-number" title="Permalink to this headline">¶</a></h3>
<p>Display the gate number to a specific user</p>
</div>
<div class="section" id="display-departure-time">
<h3>3.4.7. Display Departure Time<a class="headerlink" href="#display-departure-time" title="Permalink to this headline">¶</a></h3>
<p>Display the departure time to a specific user</p>
</div>
<div class="section" id="display-arrival-time">
<h3>3.4.8. Display Arrival Time<a class="headerlink" href="#display-arrival-time" title="Permalink to this headline">¶</a></h3>
<p>Display the arrival time to a specific user</p>
</div>
<div class="section" id="display-boarding-time">
<h3>3.4.9. Display Boarding Time<a class="headerlink" href="#display-boarding-time" title="Permalink to this headline">¶</a></h3>
<p>Display the boarding time to a specific user</p>
</div>
<div class="section" id="display-boarding-pass">
<h3>3.4.10. Display boarding pass<a class="headerlink" href="#display-boarding-pass" title="Permalink to this headline">¶</a></h3>
<p>Display the boarding pass to a specific user.</p>
<p>You can reply with any of the message formats, such as text or images,
but you can also use the predefined template for displaying a Boarding Pass described at</p>
<p><a href="#id43"><span class="problematic" id="id44">`Webhook Reply example with DataMessage - for Boarding Pass`_</span></a> .</p>
</div>
<div class="section" id="display-itinerary">
<h3>3.4.11. Display Itinerary<a class="headerlink" href="#display-itinerary" title="Permalink to this headline">¶</a></h3>
<p>Display the itinerary to a specific user</p>
</div>
<div class="section" id="display-reservation">
<h3>3.4.12. Display Reservation<a class="headerlink" href="#display-reservation" title="Permalink to this headline">¶</a></h3>
<p>Display the reservation to a specific user</p>
</div>
<div class="section" id="cancel-reservation">
<h3>3.4.13. Cancel Reservation<a class="headerlink" href="#cancel-reservation" title="Permalink to this headline">¶</a></h3>
<p>Please cancel my  reservation</p>
</div>
<div class="section" id="check-in-to-flight">
<h3>3.4.14. Check In To Flight<a class="headerlink" href="#check-in-to-flight" title="Permalink to this headline">¶</a></h3>
<p>Try &#8220;check in to my flight&#8221;</p>
</div>
<div class="section" id="display-flight-status">
<h3>3.4.15. Display Flight Status<a class="headerlink" href="#display-flight-status" title="Permalink to this headline">¶</a></h3>
<p>Allow the user to request the status of a specific flight:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>User: &quot;What is the status of United Airlines flight 123?&quot;
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-text">Flight Status Request Example</span><a class="headerlink" href="#id31" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;messagingProvider&quot;</span><span class="o">:</span> <span class="s2">&quot;FACEBOOK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441cb1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;IATA&quot;</span><span class="o">:</span> <span class="s2">&quot;UA&quot;</span><span class="p">,</span>
 <span class="s2">&quot;ICAO&quot;</span><span class="o">:</span> <span class="s2">&quot;UAL&quot;</span><span class="p">,</span>
 <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;United&quot;</span><span class="p">,</span>
 <span class="s2">&quot;number&quot;</span><span class="o">:</span> <span class="mi">123</span><span class="p">,</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
<p>You can reply with any of the message formats, such as text or images,
but you can also use the predefined template for Flight Status described at</p>
<p><a href="#id45"><span class="problematic" id="id46">`Webhook Reply example with DataMessage - for Flight Status`_</span></a> .</p>
</div>
</div>
<div class="section" id="inverse-webhooks">
<span id="label-for-inverse-webhooks"></span><h2>3.5. Inverse Webhooks<a class="headerlink" href="#inverse-webhooks" title="Permalink to this headline">¶</a></h2>
<p>Eva supports inverse webhooks to allow your application to send asynchronous messages to end users.
Common use cases are sending applicative notifications to the end users, such as &#8220;Your flight is now boarding at gate D3&#8221;.</p>
<p>There are 2 types of notifications - unicast and subscription based multicast.
Unicast messages are sent to a single conversation,
while subscription based multicast messages are sent to a subscription list of conversations.
As usual, Eva handles all the formatting and glue logic for you, so you can send simple messages and the BotKit will reformat
Them as needed for the specific messaging platforms.</p>
<p>The format of the messages is the same as the reply from the applicative webhooks.</p>
<p>Unicast messages are sent to the following URL:</p>
<p><a class="reference external" href="https://chat.evature.com/send_botkit_message">https://chat.evature.com/send_botkit_message</a></p>
<p>Subscription Multicast messages are sent to the following URL:</p>
<p><a class="reference external" href="http://chat.evature.com/update_subscription">http://chat.evature.com/update_subscription</a></p>
<p>All inverse webhooks are HTTPS posts with a JSON payload.
The payload is a simple JSON object with a &#8220;siteCode&#8221; key and the &#8220;apiKey&#8221; secret.</p>
<div class="literal-block-wrapper docutils container" id="id32">
<div class="code-block-caption"><span class="caption-text">Single Text message sent as a Notification</span><a class="headerlink" href="#id32" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;siteCode&quot;</span><span class="o">:</span> <span class="s2">&quot;your_site_code&quot;</span><span class="p">,</span>
  <span class="s2">&quot;apiKey&quot;</span><span class="o">:</span> <span class="s2">&quot;your_api_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chatKey&quot;</span><span class="o">:</span> <span class="s2">&quot;3648b2a2-1aee-4d5a-7ef4-13a0aa441c21&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Good Morning!&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>to send a message to an existing subscription:</p>
<div class="literal-block-wrapper docutils container" id="id33">
<div class="code-block-caption"><span class="caption-text">Notification Group Message, sent as a Notification</span><a class="headerlink" href="#id33" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;botkitVersion&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;siteCode&quot;</span><span class="o">:</span> <span class="s2">&quot;your_site_code&quot;</span><span class="p">,</span>
  <span class="s2">&quot;apiKey&quot;</span><span class="o">:</span> <span class="s2">&quot;your_api_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;requestType&quot;</span><span class="o">:</span> <span class="s2">&quot;send_message&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscriptionId&quot;</span><span class="o">:</span> <span class="s2">&quot;Flight UA-123 January 10th&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;TextMessage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Your flight has been delayed but here is a picture of a cute dog:&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;_type&quot;</span><span class="o">:</span> <span class="s2">&quot;ImageMessage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;imageUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;https://storage.googleapis.com/linebot-1275.appspot.com/monaka1.jpg&quot;</span>
      <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>To remove an existing subscription (delete and unsubscribe all end users) send the following:</p>
<div class="literal-block-wrapper docutils container" id="id34">
<div class="code-block-caption"><span class="caption-text">Delete subscription list, sent as a Notification</span><a class="headerlink" href="#id34" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;siteCode&quot;</span><span class="o">:</span> <span class="s2">&quot;your_site_code&quot;</span><span class="p">,</span>
  <span class="s2">&quot;apiKey&quot;</span><span class="o">:</span> <span class="s2">&quot;your_api_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;requestType&quot;</span><span class="o">:</span> <span class="s2">&quot;remove_subscription&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subscriptionId&quot;</span><span class="o">:</span> <span class="s2">&quot;subscription_id&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="secure-invitations">
<h2>3.6. Secure Invitations<a class="headerlink" href="#secure-invitations" title="Permalink to this headline">¶</a></h2>
<p>Secure Invitations allow a Bot to invite known non-bot users to use the bot while maintaining their identity.
If you already have a login-protected webpage for all end users,
you may wish to use the <a class="reference internal" href="#interactive-message-logging-in-end-users-oauth">Interactive Message - Logging In End Users - OAuth</a></p>
<p>Secure Invitations (simplified version) consist of 3 steps:</p>
<p>1. Request a secure invitation for an end user.
You provide your credentials and the internal-identity of the end user you wish to invite.
We reply with a secure token.</p>
<p>HTTPS Post to &#8220;<a class="reference external" href="https://chat.evature.com/generate_secure_invitation">https://chat.evature.com/generate_secure_invitation</a>&#8221; with this JSON payload:</p>
<div class="literal-block-wrapper docutils container" id="id35">
<div class="code-block-caption"><span class="caption-text">Example JSON Secure Invitation Request</span><a class="headerlink" href="#id35" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;site_code&quot;</span><span class="o">:</span> <span class="s2">&quot;my_site_code&quot;</span><span class="p">,</span>
  <span class="s2">&quot;api_key&quot;</span><span class="o">:</span> <span class="s2">&quot;my_api_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;api_key&quot;</span><span class="o">:</span> <span class="s2">&quot;my_api_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;facebook_page_id&quot;</span><span class="o">:</span> <span class="s2">&quot;my_facebook_page_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;telegram_channel_id&quot;</span><span class="o">:</span> <span class="s2">&quot;my_telegram_channel_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;private_id&quot;</span><span class="o">:</span> <span class="s2">&quot;private_id_of_an_end_user&quot;</span><span class="p">,</span>
  <span class="s2">&quot;already_authenticated&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can only request one of <code class="docutils literal"><span class="pre">facebook_page_id</span></code> and <code class="docutils literal"><span class="pre">telegram_channel_id</span></code> at a time</p>
</div>
<div class="literal-block-wrapper docutils container" id="id36">
<div class="code-block-caption"><span class="caption-text">Example JSON Response for Telegram</span><a class="headerlink" href="#id36" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;referral&quot;</span><span class="o">:</span> <span class="s2">&quot;some_random_string&quot;</span><span class="p">,</span>
  <span class="s2">&quot;referralUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;https://telegram.me/EvatureHotelsBot?start=some_random_string&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id37">
<div class="code-block-caption"><span class="caption-text">Example JSON Response for Facebook Messenger</span><a class="headerlink" href="#id37" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;referral&quot;</span><span class="o">:</span> <span class="s2">&quot;some_random_string&quot;</span><span class="p">,</span>
  <span class="s2">&quot;referralUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;https://m.me/1749750371937776?ref=some_random_string&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li>Email or SMS the referral link to end users.</li>
</ol>
<p>3. When the end user clicks on the link, Facebook Messenger opens, with a privacy message, such as
&#8220;You opened this conversation with m.me/eva.tech.demo. eva.ai can see that you used their link.&#8221;
- This comes from Facebook, not from us, and cannot be customized.</p>
<p>Telegram Bots present the user with a &#8220;Start&#8221; button.
- This comes from Telegram, not from us, and cannot be customized.</p>
<p>The Bot tells the user:
&#8220;You have now successfully authenticated!&#8221;</p>
<p>Every subsequent webhook call in the interaction with this specific end user will have the private internal ID
of the person in the payload:</p>
<div class="literal-block-wrapper docutils container" id="id38">
<div class="code-block-caption"><span class="caption-text">Simplified Payload-Part After A Successful Secure Invitation</span><a class="headerlink" href="#id38" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;privateId&quot;</span><span class="o">:</span> <span class="s2">&quot;private_id_of_an_end_user&quot;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>So when this user says &#8220;Show me my boarding pass&#8221;, we notify you and you know what data to return.</p>
</div>
<div class="section" id="confidence">
<h2>3.7. Confidence<a class="headerlink" href="#confidence" title="Permalink to this headline">¶</a></h2>
<p>Eva based bots automatically measure their confidence in their ability to successfully comprehend end users.
Each transaction in a dialog is rated on a scale of 0 to 1 and BotKit allows your bots to take action
if and when the confidence drops below a user-configurable threshold.
Confidence may drop as a result of many variables, such as very bad spelling mistakes,
repeated unanswered questions, &#8220;strange&#8221; locations or times or misunderstood parts of the input.
An automatic Bot action can be:</p>
<blockquote>
<div><ul class="simple">
<li>Please Rephrase: &#8220;I&#8217;m sorry but I&#8217;m not sure I understood you correctly. Would you please rephrase your request?&#8221;</li>
<li>Restart Session: &#8220;Can we please start over?&#8221;</li>
<li>Transfer to Human: &#8220;Would you like me to hand off the conversation to a service professional?&#8221;</li>
<li>Any combination of the above, including actually <strong>ASKING</strong> the end user which of the above she prefers.</li>
</ul>
</div></blockquote>
<div class="figure align-center">
<img alt="Low Confidence in Action" src="_images/Screenshot6.png" />
</div>
<p>Confidence also allows service professionals using
<a class="reference external" href="http://www.evature.com/eva-chat">Eva Chat</a>
to sort the ongoing Bot conversations by confidence,
listen in on them and even take them over, allowing better usage of their time and attention.</p>
<div class="figure align-center">
<img alt="Low Confidence in Eva Chat" src="_images/Screenshot8.png" />
</div>
<div class="section" id="setup">
<h3>3.7.1. Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<p>Setup of configurable Low Confidence behavior consists of two steps:</p>
<ol class="arabic simple">
<li>Set your desired Low Confidence threshold, on a scale of 0 to 1.</li>
<li>Configure the desired behavior for your Bots.</li>
</ol>
<div class="figure align-center" id="id39">
<img alt="Low Confidence threshold configuration" src="_images/Screenshot2.png" />
<p class="caption"><span class="caption-text">In your <a class="reference external" href="https://chat.evature.com/botkit">BotKit admin page</a>, select Eva Settings.</span></p>
</div>
<div class="figure align-center" id="id40">
<img alt="Low Confidence threshold configuration" src="_images/Screenshot3.png" />
<p class="caption"><span class="caption-text">You can set the low confidence threshold for your bots anywhere between 0 and 1.</span></p>
</div>
<p>Customize the webhook behavior just like any other webhook, using simple text replies,
Customizable Static Replies, Programmable Replies or use the pre-programmed (no coding required)
Customizable Low Confidence Handler, which allows you to configure the results using
a simple JSON structure in our web-based JSON editor.</p>
<div class="figure align-center" id="id41">
<img alt="Low Confidence Webhook Configuration" src="_images/Screenshot4.png" />
<p class="caption"><span class="caption-text">Customize as with any webhook OR use our pre-configured handler</span></p>
</div>
<p>This is an example of the JSON editor for the contents or the Customizable Low Confidence Handler.
The code returns messages (of any supported message type, such as text or an image)
and asks the end user how she would like to proceed. The &#8220;Quick Replies&#8221; question displays up to 3 configurable choices -
Restart the session, Handoff the conversation to a human representative or continue chatting with the bot.</p>
<div class="figure align-center">
<img alt="JSON Low Confidence Webhook Configuration" src="_images/Screenshot5.png" />
</div>
</div>
<div class="section" id="how-it-works">
<h3>3.7.2. How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h3>
<p>Confidence is a supervised machine learning algorithm that runs in parallel to the entire NLU and Business Logic stacks.
The algorithm learns based on the input data to assess the probability that Eva is on track with the dialog
and that the conversation will successfully converge.</p>
<div class="figure align-center" id="id42">
<img alt="Confidence at the Raw NLU API output" src="_images/Screenshot7.png" />
<p class="caption"><span class="caption-text">Confidence is also available in the <a class="reference external" href="http://docs.evature.com/api.html">Raw NLU API</a>.</span></p>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="4. The HTTP RESTful API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sdks.html" class="btn btn-neutral" title="2. The Mobile SDKs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016, 2017 Evature.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12901638-1', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>